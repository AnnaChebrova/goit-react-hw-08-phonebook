(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{6:function(e,t,n){e.exports={container:"phonebook_container__3IYyu",form:"phonebook_form__YrK7j",inputName:"phonebook_inputName__ck9vQ",inputTel:"phonebook_inputTel__2mT5k",btnForm:"phonebook_btnForm__ew3Ql",error:"phonebook_error__1aDRH",list:"phonebook_list__1ZApi",contact:"phonebook_contact__2uld3",btnList:"phonebook_btnList__2HFiY",inputFilter:"phonebook_inputFilter__-Kmb0",btnFilter:"phonebook_btnFilter__ixVCo",btnLogout:"phonebook_btnLogout__3spRX",btnLogoutDisabled:"phonebook_btnLogoutDisabled__1LyHN"}},86:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(27),o=n.n(a),i=n(4),s=n(3),u=n(6),l=n.n(u),b="/",j="/register",d="/login",p="/contacts",h=n(1),f={container:{minHeight:"calc(100vh - 50px)",display:"flex",alignItems:"center",justifyContent:"center"},title:{fontWeight:500,fontSize:48,textAlign:"center"}},O=function(){return Object(h.jsx)("div",{style:f.container,children:Object(h.jsxs)("h1",{style:f.title,children:['\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 "\u0422\u0435\u043b\u0435\u0444\u043e\u043d\u043d\u0430\u044f \u043a\u043d\u0438\u0433\u0430"'," "]})})},m=n(12),x=n(16),g=n.n(x),v=n(23),y=n(15),k=n.n(y),_=n(14),C="https://connections-api.herokuapp.com",S=function(e){k.a.defaults.headers.common.Authorization="Bearer ".concat(e)},w=function(){k.a.defaults.headers.common.Authorization=""},L=Object(_.b)("".concat(C,"auth/register"),function(){var e=Object(v.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.post("".concat(C,"/users/signup"),t);case 3:return n=e.sent,c=n.data,S(c.token),e.abrupt("return",c);case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),T=Object(_.b)("".concat(C,"auth/login"),function(){var e=Object(v.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.post("".concat(C,"/users/login"),t);case 3:return n=e.sent,c=n.data,S(c.token),e.abrupt("return",c);case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),I={register:L,logOut:Object(_.b)("".concat(C,"auth/logout"),Object(v.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.post("".concat(C,"/users/logout"));case 3:w(),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))),logIn:T,fetchCurrentUser:Object(_.b)("".concat(C,"auth/refresh"),function(){var e=Object(v.a)(g.a.mark((function e(t,n){var c,r,a,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.getState(),null!==(r=c.auth.token)){e.next=4;break}return e.abrupt("return",n.rejectWithValue());case 4:return S(r),e.prev=5,e.next=8,k.a.get("".concat(C,"/users/current"));case 8:return a=e.sent,o=a.data,e.abrupt("return",o);case 13:e.prev=13,e.t0=e.catch(5);case 15:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,n){return e.apply(this,arguments)}}())},N={form:{width:320},label:{display:"flex",flexDirection:"column",marginBottom:15}};function F(){var e=Object(s.b)(),t=Object(c.useState)(""),n=Object(m.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(""),i=Object(m.a)(o,2),u=i[0],l=i[1],b=Object(c.useState)(""),j=Object(m.a)(b,2),d=j[0],p=j[1],f=function(e){var t=e.target,n=t.name,c=t.value;switch(n){case"name":return a(c);case"email":return l(c);case"password":return p(c);default:return}};return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"}),Object(h.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(I.register({name:r,email:u,password:d})),a(""),l(""),p("")},style:N.form,autoComplete:"off",children:[Object(h.jsxs)("label",{style:N.label,children:["\u0418\u043c\u044f",Object(h.jsx)("input",{type:"text",name:"name",value:r,onChange:f})]}),Object(h.jsxs)("label",{style:N.label,children:["\u041f\u043e\u0447\u0442\u0430",Object(h.jsx)("input",{type:"email",name:"email",value:u,onChange:f})]}),Object(h.jsxs)("label",{style:N.label,children:["\u041f\u0430\u0440\u043e\u043b\u044c",Object(h.jsx)("input",{type:"password",name:"password",value:d,onChange:f})]}),Object(h.jsx)("button",{type:"submit",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})]})}var A={form:{width:320},label:{display:"flex",flexDirection:"column",marginBottom:15}};function E(){var e=Object(s.b)(),t=Object(c.useState)(""),n=Object(m.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(""),i=Object(m.a)(o,2),u=i[0],l=i[1],b=function(e){var t=e.target,n=t.name,c=t.value;switch(n){case"email":return a(c);case"password":return l(c);default:return}};return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043b\u043e\u0433\u0438\u043d\u0430"}),Object(h.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(I.logIn({email:r,password:u})),a(""),l("")},style:A.form,autoComplete:"off",children:[Object(h.jsxs)("label",{style:A.label,children:["\u041f\u043e\u0447\u0442\u0430",Object(h.jsx)("input",{type:"email",name:"email",value:r,onChange:b})]}),Object(h.jsxs)("label",{style:A.label,children:["\u041f\u0430\u0440\u043e\u043b\u044c",Object(h.jsx)("input",{type:"password",name:"password",value:u,onChange:b})]}),Object(h.jsx)("button",{type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}var D=Object(_.c)({name:"contacts",initialState:{items:[],query:"",error:""},reducers:{getContactsSuccess:function(e,t){e.items=t.payload},getContactsFailure:function(e,t){e.error=t.payload.error},addContactSuccess:function(e,t){e.items.some((function(e){return e.name===t.payload.name}))?e.error="This contact is already exists in contacts":e.items.push(t.payload)},addContactFailure:function(e,t){e.error=t.payload.error},deleteContactSuccess:function(e,t){e.items=e.items.filter((function(e){return e.id!==t.payload}))},updateQuery:function(e,t){e.query=t.payload.toLowerCase()}}}),B=D.actions,R=B.getContactsSuccess,U=B.getContactsFailure,z=B.addContactSuccess,Q=B.addContactFailure,q=B.deleteContactSuccess,W=B.updateQuery,H=D.reducer,Z="https://connections-api.herokuapp.com";var J=n(19),Y=function(e){return e.contacts.items},K=function(e){return e.contacts.error},M=Object(J.a)([Y,function(e){return e.contacts.query}],(function(e,t){return e.filter((function(e){return e.name.toLowerCase().includes(t)}))}));var V=function(){var e=Object(s.b)(),t=Object(s.c)(Y);Object(c.useEffect)((function(){e((function(e){return e({type:"GET_CONTACTS_REQUEST"}),k.a.get("".concat(Z,"/contacts")).then((function(t){e(R(t.data))})).catch((function(t){e(U({error:t.toString()}))}))}))}),[e]);var n=function(t){e(function(e){return function(t){return t({type:"DELETE_CONTACT_REQUEST"}),k.a.delete("".concat(Z,"/contacts/").concat(e)).then((function(){t(q(e))})).catch((function(e){t({type:"DELETE_CONTACT_FAILURE",payload:{error:e.toString()}})}))}}(t))};return Object(h.jsx)("div",{className:l.a.list,children:t&&t.map((function(e){return Object(h.jsxs)("p",{className:l.a.contact,children:[e.name,": ",e.number,Object(h.jsx)("button",{type:"button",onClick:function(){return n(e.id)},className:l.a.btnList,children:"delete contact"})]},e.id)}))})},G=n(42),P=n.n(G),X=function(){var e=Object(c.useState)(""),t=Object(m.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(""),o=Object(m.a)(a,2),i=o[0],u=o[1],b=Object(s.b)(),j=Object(s.c)(K),d=function(e){var t=e.currentTarget,n=t.name,c=t.value;switch(n){case"name":r(c);break;case"number":u(c);break;default:return}};return Object(h.jsxs)("div",{children:[Object(h.jsx)("form",{className:l.a.form,onSubmit:function(e){e.preventDefault();var t,c={id:P.a.generate(),name:n,number:i};b((t=c,function(e){return k.a.post("".concat(Z,"/contacts"),t).then((function(t){e(z(t.data))})).catch((function(t){e(Q({error:t.toString()}))}))})),r(""),u("")},children:Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("label",{children:[" ","Name",Object(h.jsx)("input",{type:"text",name:"name",pattern:"^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$",title:"\u0418\u043c\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u0431\u0443\u043a\u0432, \u0430\u043f\u043e\u0441\u0442\u0440\u043e\u0444\u0430, \u0442\u0438\u0440\u0435 \u0438 \u043f\u0440\u043e\u0431\u0435\u043b\u043e\u0432. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan \u0438 \u0442. \u043f.",className:l.a.inputName,value:n,onChange:d,required:!0})]}),Object(h.jsxs)("label",{children:["Tel",Object(h.jsx)("input",{type:"tel",name:"number",pattern:"\\+?\\d{1,4}?[-.\\s]?\\(?\\d{1,3}?\\)?[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,9}",title:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0446\u0438\u0444\u0440 \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043f\u0440\u043e\u0431\u0435\u043b\u044b, \u0442\u0438\u0440\u0435, \u043a\u0440\u0443\u0433\u043b\u044b\u0435 \u0441\u043a\u043e\u0431\u043a\u0438 \u0438 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0441 +",className:l.a.inputTel,value:i,onChange:d,required:!0})]}),Object(h.jsx)("button",{type:"submit",className:l.a.btnForm,children:"Add contact"})]})}),j&&Object(h.jsx)("p",{className:l.a.error,children:j})]})};var $=function(){var e=Object(s.b)(),t=Object(s.c)(M),n=Object(c.useState)(""),r=Object(m.a)(n,2),a=r[0],o=r[1],i=Object(c.useCallback)((function(e){o(e.target.value)}),[]),u=Object(c.useCallback)((function(){e(W(a))}),[a]);return Object(h.jsxs)("div",{children:[Object(h.jsxs)("label",{children:["Find contacts by name",Object(h.jsx)("input",{type:"text",value:a,onChange:i,className:l.a.inputFilter}),Object(h.jsx)("button",{onClick:u,className:l.a.btnFilter,children:"\u041d\u0430\u0439\u0442\u0438 \u043a\u043e\u043d\u0442\u0430\u043a\u0442"})]}),a&&t.map((function(e){return Object(h.jsxs)("p",{children:[e.name,": ",e.number]},e.id)}))]})};function ee(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h1",{children:"Phonebook"}),Object(h.jsx)(X,{}),Object(h.jsx)("h2",{children:"Contacts"}),Object(h.jsx)(V,{}),Object(h.jsx)($,{})]})}var te=n(13),ne={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}},ce=function(){return Object(h.jsxs)("nav",{children:[Object(h.jsx)(te.b,{to:"/",exact:!0,style:ne.link,activeStyle:ne.activeLink,children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"}),Object(h.jsx)(te.b,{to:"/contacts",exact:!0,style:ne.link,activeStyle:ne.activeLink,children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043e\u0432"})]})},re={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUserName:function(e){return e.auth.user.name}},ae={container:{display:"flex",alignItems:"center"},avatar:{marginRight:4},name:{fontWeight:700,marginRight:12}};function oe(){var e=Object(s.b)(),t=Object(s.c)(re.getUserName);return Object(h.jsxs)("div",{style:ae.container,children:[Object(h.jsxs)("span",{style:ae.name,children:["\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c, ",t]}),Object(h.jsx)("button",{type:"button",onClick:function(){return e(I.logOut())},children:"\u0412\u044b\u0439\u0442\u0438"})]})}var ie={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}};function se(){return Object(h.jsxs)("div",{children:[Object(h.jsx)(te.b,{to:"/register",exact:!0,style:ie.link,activeStyle:ie.activeLink,children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(h.jsx)(te.b,{to:"/login",exact:!0,style:ie.link,activeStyle:ie.activeLink,children:"\u041b\u043e\u0433\u0438\u043d"})]})}var ue={header:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #2A363B"}};function le(){var e=Object(s.c)(re.getIsLoggedIn);return Object(h.jsxs)("header",{style:ue.header,children:[Object(h.jsx)(ce,{}),e?Object(h.jsx)(oe,{}):Object(h.jsx)(se,{})]})}var be=n(20),je=n(29),de=["children","redirectTo"];function pe(e){var t=e.children,n=e.redirectTo,c=void 0===n?"/":n,r=Object(je.a)(e,de),a=Object(s.c)(re.getIsLoggedIn);return Object(h.jsx)(i.b,Object(be.a)(Object(be.a)({},r),{},{children:a?t:Object(h.jsx)(i.a,{to:c})}))}var he=["children","restricted","redirectTo"];function fe(e){var t=e.children,n=e.restricted,c=void 0!==n&&n,r=e.redirectTo,a=void 0===r?"/":r,o=Object(je.a)(e,he),u=Object(s.c)(re.getIsLoggedIn)&&c;return Object(h.jsx)(i.b,Object(be.a)(Object(be.a)({},o),{},{children:u?Object(h.jsx)(i.a,{to:a}):t}))}var Oe,me=function(){var e=Object(s.b)();return Object(c.useEffect)((function(){e(I.fetchCurrentUser())}),[e]),Object(h.jsxs)("div",{className:l.a.container,children:[Object(h.jsx)(le,{}),Object(h.jsx)(i.d,{children:Object(h.jsxs)(c.Suspense,{fallback:Object(h.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c..."}),children:[Object(h.jsx)(fe,{exact:!0,path:b,component:O}),Object(h.jsx)(fe,{exact:!0,path:j,component:F,restricted:!0}),Object(h.jsx)(fe,{exact:!0,path:d,component:E,redirectTo:p,restricted:!0}),Object(h.jsx)(pe,{path:p,component:ee,redirectTo:d})]})})]})},xe=n(44),ge=n(5),ve=n(22),ye=n(17),ke=Object(_.c)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1},extraReducers:(Oe={},Object(ye.a)(Oe,I.register.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(ye.a)(Oe,I.logIn.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(ye.a)(Oe,I.logOut.fulfilled,(function(e,t){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1})),Object(ye.a)(Oe,I.fetchCurrentUser.fulfilled,(function(e,t){e.user=t.payload,e.isLoggedIn=!0})),Oe)}).reducer,_e=n(33),Ce=n(45),Se={key:"auth",storage:n.n(Ce).a,whitelist:["token"]},we=Object(ge.a)(ve.a,(function(e){return function(t){return function(n){return console.group(n.type),console.info("dispatching",n),console.info("store",e),console.groupEnd(n.type),t(n)}}})),Le=Object(_.a)({reducer:{contacts:H,auth:Object(_e.a)(Se,ke)},enhancers:[we]}),Te=Object(_e.b)(Le);n(85);o.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(s.a,{store:Le,children:Object(h.jsx)(xe.a,{loading:null,persistor:Te,children:Object(h.jsx)(te.a,{children:Object(h.jsx)(me,{})})})})}),document.getElementById("root"))}},[[86,1,2]]]);
//# sourceMappingURL=main.164f974d.chunk.js.map